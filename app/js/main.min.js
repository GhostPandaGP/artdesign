$(function(){

    // $(".rate-star").rateYo({
    //     rating    : 5,
    //     starWidth: "12px",
    //     rateFill: "#ffa726", 
    //     readOnly: true,
    //   });

    // start sliders
    $(".product-page__slider-main").slick({
        arrows: false,
        asNavFor: '.product-page__slider-mini',
    });

    $(".product-page__slider-mini").slick({
        arrows: false,
        slidesToShow: 5,
        focusOnSelect: true,
        asNavFor: '.product-page__slider-main',
    });
    // end sliders
    
    // start hide/show text
    let oldText = $(".product-page__text").text().trim().replace(/\s+/g, " ");
    hideText = () => {
        $(".product-page__text").text( (i, text) => {
    
            text = oldText;
    
            if (text.length >= 250) {
              text = text.substring(0, 205);
              var lastIndex = text.lastIndexOf(" ");       // позиция последнего пробела
              text = text.substring(0, lastIndex) + '...'; // обрезаем до последнего слова
              $(".product-page__text-box span").addClass("open-more--on");
            }
            
            $(".product-page__text").text(text);
            
          });
    }
    hideText();
    $(".product-page__text-box span").on("click", () => {
        // console.log("-----", $(this));
        if ($(".product-page__text-box span").data("state") === "hide") {
            $(".product-page__text").text(oldText);
            $(".product-page__text-box span").data("state", "show");
            $(".product-page__text-box span").text("Скрыть");
        } else {
            if ($(".product-page__text-box span").data("state") === "show") {
                hideText();
                $(".product-page__text-box span").data("state", "hide");
                $(".product-page__text-box span").text("Читать далее");
            }
        }
        console.log("---", $(".product-page__text-box span").data("state"));
    });
    // end hide/show text

    // start timer
    const 
        second = 1000,
        minute = second * 60,
        hour = minute * 60,
        day = hour * 24;

    let countDown = new Date($(".product-page__timer").data("date")).getTime(),
        x = setInterval(() => {

            let now = new Date().getTime(),
                distance = countDown - now,
                numberDays = Math.floor(distance / (day));

            if (distance > 0) {
                $(".product-page__timer").addClass("product-page__timer--on");
            }

            if (numberDays >= 1){
                $('.product-page__timer-days').text(numberDays);
                $(".product-page__timer").addClass("product-page__timer--long");
            } else {
                $('.product-page__timer-hours').text(Math.floor((distance % (day)) / (hour)));
                $('.product-page__timer-minutes').text(Math.floor((distance % (hour)) / (minute)));
                $('.product-page__timer-seconds').text(Math.floor((distance % (minute)) / second));
                $(".product-page__timer").removeClass("product-page__timer--long");
            }

        }, second)
    // end timer

    // $(".js-range-slider").ionRangeSlider({
    //     type: "double",
    //     min: 0,
    //     max: 1000,
    //     from: 0,
    //     to: 600,
    //     skin: "round",
    //     prefix: "$",
    // });

    // $('.icon-th-list').on('click', () => {
    //     $('.products__item').addClass('list');
        
    //     $('.icon-th-list').addClass('active');
    //     $('.icon-th-large').removeClass('active');
    // });

    // $('.icon-th-large').on('click', () => {
    //     $('.products__item').removeClass('list');

    //     $('.icon-th-large').addClass('active');
    //     $('.icon-th-list').removeClass('active');
    // });

    // let mixer = mixitup('.products__inner-box');
    
    console.log("js loaded");
})